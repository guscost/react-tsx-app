define(["require", "exports", "react/jsx-runtime", "react", "embla-carousel-react", "lucide-react", "@/lib/utils", "@/components/ui/button"], function (require, exports, jsx_runtime_1, React, embla_carousel_react_1, lucide_react_1, utils_1, button_1) {
    "use client";
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.Carousel = Carousel;
    exports.CarouselContent = CarouselContent;
    exports.CarouselItem = CarouselItem;
    exports.CarouselPrevious = CarouselPrevious;
    exports.CarouselNext = CarouselNext;
    const CarouselContext = React.createContext(null);
    function useCarousel() {
        const context = React.useContext(CarouselContext);
        if (!context) {
            throw new Error("useCarousel must be used within a <Carousel />");
        }
        return context;
    }
    function Carousel({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }) {
        const [carouselRef, api] = (0, embla_carousel_react_1.default)({
            ...opts,
            axis: orientation === "horizontal" ? "x" : "y",
        }, plugins);
        const [canScrollPrev, setCanScrollPrev] = React.useState(false);
        const [canScrollNext, setCanScrollNext] = React.useState(false);
        const onSelect = React.useCallback((api) => {
            if (!api)
                return;
            setCanScrollPrev(api.canScrollPrev());
            setCanScrollNext(api.canScrollNext());
        }, []);
        const scrollPrev = React.useCallback(() => {
            api === null || api === void 0 ? void 0 : api.scrollPrev();
        }, [api]);
        const scrollNext = React.useCallback(() => {
            api === null || api === void 0 ? void 0 : api.scrollNext();
        }, [api]);
        const handleKeyDown = React.useCallback((event) => {
            if (event.key === "ArrowLeft") {
                event.preventDefault();
                scrollPrev();
            }
            else if (event.key === "ArrowRight") {
                event.preventDefault();
                scrollNext();
            }
        }, [scrollPrev, scrollNext]);
        React.useEffect(() => {
            if (!api || !setApi)
                return;
            setApi(api);
        }, [api, setApi]);
        React.useEffect(() => {
            if (!api)
                return;
            onSelect(api);
            api.on("reInit", onSelect);
            api.on("select", onSelect);
            return () => {
                api === null || api === void 0 ? void 0 : api.off("select", onSelect);
            };
        }, [api, onSelect]);
        return ((0, jsx_runtime_1.jsx)(CarouselContext.Provider, { value: {
                carouselRef,
                api: api,
                opts,
                orientation: orientation || ((opts === null || opts === void 0 ? void 0 : opts.axis) === "y" ? "vertical" : "horizontal"),
                scrollPrev,
                scrollNext,
                canScrollPrev,
                canScrollNext,
            }, children: (0, jsx_runtime_1.jsx)("div", { onKeyDownCapture: handleKeyDown, className: (0, utils_1.cn)("relative", className), role: "region", "aria-roledescription": "carousel", "data-slot": "carousel", ...props, children: children }) }));
    }
    function CarouselContent({ className, ...props }) {
        const { carouselRef, orientation } = useCarousel();
        return ((0, jsx_runtime_1.jsx)("div", { ref: carouselRef, className: "overflow-hidden", "data-slot": "carousel-content", children: (0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("flex", orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col", className), ...props }) }));
    }
    function CarouselItem({ className, ...props }) {
        const { orientation } = useCarousel();
        return ((0, jsx_runtime_1.jsx)("div", { role: "group", "aria-roledescription": "slide", "data-slot": "carousel-item", className: (0, utils_1.cn)("min-w-0 shrink-0 grow-0 basis-full", orientation === "horizontal" ? "pl-4" : "pt-4", className), ...props }));
    }
    function CarouselPrevious({ className, variant = "outline", size = "icon", ...props }) {
        const { orientation, scrollPrev, canScrollPrev } = useCarousel();
        return ((0, jsx_runtime_1.jsxs)(button_1.Button, { "data-slot": "carousel-previous", variant: variant, size: size, className: (0, utils_1.cn)("absolute size-8 rounded-full", orientation === "horizontal"
                ? "top-1/2 -left-12 -translate-y-1/2"
                : "-top-12 left-1/2 -translate-x-1/2 rotate-90", className), disabled: !canScrollPrev, onClick: scrollPrev, ...props, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, {}), (0, jsx_runtime_1.jsx)("span", { className: "sr-only", children: "Previous slide" })] }));
    }
    function CarouselNext({ className, variant = "outline", size = "icon", ...props }) {
        const { orientation, scrollNext, canScrollNext } = useCarousel();
        return ((0, jsx_runtime_1.jsxs)(button_1.Button, { "data-slot": "carousel-next", variant: variant, size: size, className: (0, utils_1.cn)("absolute size-8 rounded-full", orientation === "horizontal"
                ? "top-1/2 -right-12 -translate-y-1/2"
                : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90", className), disabled: !canScrollNext, onClick: scrollNext, ...props, children: [(0, jsx_runtime_1.jsx)(lucide_react_1.ArrowRight, {}), (0, jsx_runtime_1.jsx)("span", { className: "sr-only", children: "Next slide" })] }));
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2Fyb3VzZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy91aS9jYXJvdXNlbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtJQUFBLFlBQVksQ0FBQzs7O0lBMk9YLDRCQUFRO0lBQ1IsMENBQWU7SUFDZixvQ0FBWTtJQUNaLDRDQUFnQjtJQUNoQixvQ0FBWTtJQS9NZCxNQUFNLGVBQWUsR0FBRyxLQUFLLENBQUMsYUFBYSxDQUE4QixJQUFJLENBQUMsQ0FBQztJQUUvRSxTQUFTLFdBQVc7UUFDbEIsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUVsRCxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDYixNQUFNLElBQUksS0FBSyxDQUFDLGdEQUFnRCxDQUFDLENBQUM7UUFDcEUsQ0FBQztRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxTQUFTLFFBQVEsQ0FBQyxFQUNoQixXQUFXLEdBQUcsWUFBWSxFQUMxQixJQUFJLEVBQ0osTUFBTSxFQUNOLE9BQU8sRUFDUCxTQUFTLEVBQ1QsUUFBUSxFQUNSLEdBQUcsS0FBSyxFQUNvQztRQUM1QyxNQUFNLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxHQUFHLElBQUEsOEJBQWdCLEVBQ3pDO1lBQ0UsR0FBRyxJQUFJO1lBQ1AsSUFBSSxFQUFFLFdBQVcsS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRztTQUMvQyxFQUNELE9BQU8sQ0FDUixDQUFDO1FBQ0YsTUFBTSxDQUFDLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEUsTUFBTSxDQUFDLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFaEUsTUFBTSxR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RSxJQUFBLFVBQUUsRUFDWCw4QkFBOEIsRUFDOUIsV0FBVyxLQUFLLFlBQVk7Z0JBQzFCLENBQUMsQ0FBQyxtQ0FBbUM7Z0JBQ3JDLENBQUMsQ0FBQyw2Q0FBNkMsRUFDakQsU0FBUyxDQUNWLEVBQ0QsUUFBUSxFQUFFLENBQUMsYUFBYSxFQUN4QixPQUFPLEVBQUUsVUFBVSxLQUNmLEtBQUssYUFFVCx1QkFBQyx3QkFBUyxLQUFHLEVBQ2IsaUNBQU0sU0FBUyxFQUFDLFNBQVMsK0JBQXNCLElBQ3hDLENBQ1YsQ0FBQztJQUNKLENBQUM7SUFFRCxTQUFTLFlBQVksQ0FBQyxFQUNwQixTQUFTLEVBQ1QsT0FBTyxHQUFHLFNBQVMsRUFDbkIsSUFBSSxHQUFHLE1BQU0sRUFDYixHQUFHLEtBQUssRUFDNEI7UUFDcEMsTUFBTSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLEdBQUcsV0FBVyxFQUFFLENBQUM7UUFFakUsT0FBTyxDQUNMLHdCQUFDLGVBQU0saUJBQ0ssZUFBZSxFQUN6QixPQUFPLEVBQUUsT0FBTyxFQUNoQixJQUFJLEVBQUUsSUFBSSxFQUNWLFNBQVMsRUFBRSxJQUFBLFVBQUUsRUFDWCw4QkFBOEIsRUFDOUIsV0FBVyxLQUFLLFlBQVk7Z0JBQzFCLENBQUMsQ0FBQyxvQ0FBb0M7Z0JBQ3RDLENBQUMsQ0FBQyxnREFBZ0QsRUFDcEQsU0FBUyxDQUNWLEVBQ0QsUUFBUSxFQUFFLENBQUMsYUFBYSxFQUN4QixPQUFPLEVBQUUsVUFBVSxLQUNmLEtBQUssYUFFVCx1QkFBQyx5QkFBVSxLQUFHLEVBQ2QsaUNBQU0sU0FBUyxFQUFDLFNBQVMsMkJBQWtCLElBQ3BDLENBQ1YsQ0FBQztJQUNKLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgdXNlRW1ibGFDYXJvdXNlbCwge1xuICB0eXBlIFVzZUVtYmxhQ2Fyb3VzZWxUeXBlLFxufSBmcm9tIFwiZW1ibGEtY2Fyb3VzZWwtcmVhY3RcIjtcbmltcG9ydCB7IEFycm93TGVmdCwgQXJyb3dSaWdodCB9IGZyb20gXCJsdWNpZGUtcmVhY3RcIjtcblxuaW1wb3J0IHsgY24gfSBmcm9tIFwiQC9saWIvdXRpbHNcIjtcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvYnV0dG9uXCI7XG5cbnR5cGUgQ2Fyb3VzZWxBcGkgPSBVc2VFbWJsYUNhcm91c2VsVHlwZVsxXTtcbnR5cGUgVXNlQ2Fyb3VzZWxQYXJhbWV0ZXJzID0gUGFyYW1ldGVyczx0eXBlb2YgdXNlRW1ibGFDYXJvdXNlbD47XG50eXBlIENhcm91c2VsT3B0aW9ucyA9IFVzZUNhcm91c2VsUGFyYW1ldGVyc1swXTtcbnR5cGUgQ2Fyb3VzZWxQbHVnaW4gPSBVc2VDYXJvdXNlbFBhcmFtZXRlcnNbMV07XG5cbnR5cGUgQ2Fyb3VzZWxQcm9wcyA9IHtcbiAgb3B0cz86IENhcm91c2VsT3B0aW9ucztcbiAgcGx1Z2lucz86IENhcm91c2VsUGx1Z2luO1xuICBvcmllbnRhdGlvbj86IFwiaG9yaXpvbnRhbFwiIHwgXCJ2ZXJ0aWNhbFwiO1xuICBzZXRBcGk/OiAoYXBpOiBDYXJvdXNlbEFwaSkgPT4gdm9pZDtcbn07XG5cbnR5cGUgQ2Fyb3VzZWxDb250ZXh0UHJvcHMgPSB7XG4gIGNhcm91c2VsUmVmOiBSZXR1cm5UeXBlPHR5cGVvZiB1c2VFbWJsYUNhcm91c2VsPlswXTtcbiAgYXBpOiBSZXR1cm5UeXBlPHR5cGVvZiB1c2VFbWJsYUNhcm91c2VsPlsxXTtcbiAgc2Nyb2xsUHJldjogKCkgPT4gdm9pZDtcbiAgc2Nyb2xsTmV4dDogKCkgPT4gdm9pZDtcbiAgY2FuU2Nyb2xsUHJldjogYm9vbGVhbjtcbiAgY2FuU2Nyb2xsTmV4dDogYm9vbGVhbjtcbn0gJiBDYXJvdXNlbFByb3BzO1xuXG5jb25zdCBDYXJvdXNlbENvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PENhcm91c2VsQ29udGV4dFByb3BzIHwgbnVsbD4obnVsbCk7XG5cbmZ1bmN0aW9uIHVzZUNhcm91c2VsKCkge1xuICBjb25zdCBjb250ZXh0ID0gUmVhY3QudXNlQ29udGV4dChDYXJvdXNlbENvbnRleHQpO1xuXG4gIGlmICghY29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcInVzZUNhcm91c2VsIG11c3QgYmUgdXNlZCB3aXRoaW4gYSA8Q2Fyb3VzZWwgLz5cIik7XG4gIH1cblxuICByZXR1cm4gY29udGV4dDtcbn1cblxuZnVuY3Rpb24gQ2Fyb3VzZWwoe1xuICBvcmllbnRhdGlvbiA9IFwiaG9yaXpvbnRhbFwiLFxuICBvcHRzLFxuICBzZXRBcGksXG4gIHBsdWdpbnMsXG4gIGNsYXNzTmFtZSxcbiAgY2hpbGRyZW4sXG4gIC4uLnByb3BzXG59OiBSZWFjdC5Db21wb25lbnRQcm9wczxcImRpdlwiPiAmIENhcm91c2VsUHJvcHMpIHtcbiAgY29uc3QgW2Nhcm91c2VsUmVmLCBhcGldID0gdXNlRW1ibGFDYXJvdXNlbChcbiAgICB7XG4gICAgICAuLi5vcHRzLFxuICAgICAgYXhpczogb3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gXCJ4XCIgOiBcInlcIixcbiAgICB9LFxuICAgIHBsdWdpbnMsXG4gICk7XG4gIGNvbnN0IFtjYW5TY3JvbGxQcmV2LCBzZXRDYW5TY3JvbGxQcmV2XSA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NhblNjcm9sbE5leHQsIHNldENhblNjcm9sbE5leHRdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpO1xuXG4gIGNvbnN0IG9uU2VsZWN0ID0gUmVhY3QudXNlQ2FsbGJhY2soKGFwaTogQ2Fyb3VzZWxBcGkpID0+IHtcbiAgICBpZiAoIWFwaSkgcmV0dXJuO1xuICAgIHNldENhblNjcm9sbFByZXYoYXBpLmNhblNjcm9sbFByZXYoKSk7XG4gICAgc2V0Q2FuU2Nyb2xsTmV4dChhcGkuY2FuU2Nyb2xsTmV4dCgpKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHNjcm9sbFByZXYgPSBSZWFjdC51c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgYXBpPy5zY3JvbGxQcmV2KCk7XG4gIH0sIFthcGldKTtcblxuICBjb25zdCBzY3JvbGxOZXh0ID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGFwaT8uc2Nyb2xsTmV4dCgpO1xuICB9LCBbYXBpXSk7XG5cbiAgY29uc3QgaGFuZGxlS2V5RG93biA9IFJlYWN0LnVzZUNhbGxiYWNrKFxuICAgIChldmVudDogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MRGl2RWxlbWVudD4pID0+IHtcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dMZWZ0XCIpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgc2Nyb2xsUHJldigpO1xuICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dSaWdodFwiKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNjcm9sbE5leHQoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtzY3JvbGxQcmV2LCBzY3JvbGxOZXh0XSxcbiAgKTtcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghYXBpIHx8ICFzZXRBcGkpIHJldHVybjtcbiAgICBzZXRBcGkoYXBpKTtcbiAgfSwgW2FwaSwgc2V0QXBpXSk7XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWFwaSkgcmV0dXJuO1xuICAgIG9uU2VsZWN0KGFwaSk7XG4gICAgYXBpLm9uKFwicmVJbml0XCIsIG9uU2VsZWN0KTtcbiAgICBhcGkub24oXCJzZWxlY3RcIiwgb25TZWxlY3QpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGFwaT8ub2ZmKFwic2VsZWN0XCIsIG9uU2VsZWN0KTtcbiAgICB9O1xuICB9LCBbYXBpLCBvblNlbGVjdF0pO1xuXG4gIHJldHVybiAoXG4gICAgPENhcm91c2VsQ29udGV4dC5Qcm92aWRlclxuICAgICAgdmFsdWU9e3tcbiAgICAgICAgY2Fyb3VzZWxSZWYsXG4gICAgICAgIGFwaTogYXBpLFxuICAgICAgICBvcHRzLFxuICAgICAgICBvcmllbnRhdGlvbjpcbiAgICAgICAgICBvcmllbnRhdGlvbiB8fCAob3B0cz8uYXhpcyA9PT0gXCJ5XCIgPyBcInZlcnRpY2FsXCIgOiBcImhvcml6b250YWxcIiksXG4gICAgICAgIHNjcm9sbFByZXYsXG4gICAgICAgIHNjcm9sbE5leHQsXG4gICAgICAgIGNhblNjcm9sbFByZXYsXG4gICAgICAgIGNhblNjcm9sbE5leHQsXG4gICAgICB9fVxuICAgID5cbiAgICAgIDxkaXZcbiAgICAgICAgb25LZXlEb3duQ2FwdHVyZT17aGFuZGxlS2V5RG93bn1cbiAgICAgICAgY2xhc3NOYW1lPXtjbihcInJlbGF0aXZlXCIsIGNsYXNzTmFtZSl9XG4gICAgICAgIHJvbGU9XCJyZWdpb25cIlxuICAgICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj1cImNhcm91c2VsXCJcbiAgICAgICAgZGF0YS1zbG90PVwiY2Fyb3VzZWxcIlxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICA+XG4gICAgICAgIHtjaGlsZHJlbn1cbiAgICAgIDwvZGl2PlxuICAgIDwvQ2Fyb3VzZWxDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufVxuXG5mdW5jdGlvbiBDYXJvdXNlbENvbnRlbnQoeyBjbGFzc05hbWUsIC4uLnByb3BzIH06IFJlYWN0LkNvbXBvbmVudFByb3BzPFwiZGl2XCI+KSB7XG4gIGNvbnN0IHsgY2Fyb3VzZWxSZWYsIG9yaWVudGF0aW9uIH0gPSB1c2VDYXJvdXNlbCgpO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgcmVmPXtjYXJvdXNlbFJlZn1cbiAgICAgIGNsYXNzTmFtZT1cIm92ZXJmbG93LWhpZGRlblwiXG4gICAgICBkYXRhLXNsb3Q9XCJjYXJvdXNlbC1jb250ZW50XCJcbiAgICA+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgICAgXCJmbGV4XCIsXG4gICAgICAgICAgb3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gXCItbWwtNFwiIDogXCItbXQtNCBmbGV4LWNvbFwiLFxuICAgICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgKX1cbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuZnVuY3Rpb24gQ2Fyb3VzZWxJdGVtKHsgY2xhc3NOYW1lLCAuLi5wcm9wcyB9OiBSZWFjdC5Db21wb25lbnRQcm9wczxcImRpdlwiPikge1xuICBjb25zdCB7IG9yaWVudGF0aW9uIH0gPSB1c2VDYXJvdXNlbCgpO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgcm9sZT1cImdyb3VwXCJcbiAgICAgIGFyaWEtcm9sZWRlc2NyaXB0aW9uPVwic2xpZGVcIlxuICAgICAgZGF0YS1zbG90PVwiY2Fyb3VzZWwtaXRlbVwiXG4gICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICBcIm1pbi13LTAgc2hyaW5rLTAgZ3Jvdy0wIGJhc2lzLWZ1bGxcIixcbiAgICAgICAgb3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gXCJwbC00XCIgOiBcInB0LTRcIixcbiAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgKX1cbiAgICAgIHsuLi5wcm9wc31cbiAgICAvPlxuICApO1xufVxuXG5mdW5jdGlvbiBDYXJvdXNlbFByZXZpb3VzKHtcbiAgY2xhc3NOYW1lLFxuICB2YXJpYW50ID0gXCJvdXRsaW5lXCIsXG4gIHNpemUgPSBcImljb25cIixcbiAgLi4ucHJvcHNcbn06IFJlYWN0LkNvbXBvbmVudFByb3BzPHR5cGVvZiBCdXR0b24+KSB7XG4gIGNvbnN0IHsgb3JpZW50YXRpb24sIHNjcm9sbFByZXYsIGNhblNjcm9sbFByZXYgfSA9IHVzZUNhcm91c2VsKCk7XG5cbiAgcmV0dXJuIChcbiAgICA8QnV0dG9uXG4gICAgICBkYXRhLXNsb3Q9XCJjYXJvdXNlbC1wcmV2aW91c1wiXG4gICAgICB2YXJpYW50PXt2YXJpYW50fVxuICAgICAgc2l6ZT17c2l6ZX1cbiAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgIFwiYWJzb2x1dGUgc2l6ZS04IHJvdW5kZWQtZnVsbFwiLFxuICAgICAgICBvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCJcbiAgICAgICAgICA/IFwidG9wLTEvMiAtbGVmdC0xMiAtdHJhbnNsYXRlLXktMS8yXCJcbiAgICAgICAgICA6IFwiLXRvcC0xMiBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIHJvdGF0ZS05MFwiLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICApfVxuICAgICAgZGlzYWJsZWQ9eyFjYW5TY3JvbGxQcmV2fVxuICAgICAgb25DbGljaz17c2Nyb2xsUHJldn1cbiAgICAgIHsuLi5wcm9wc31cbiAgICA+XG4gICAgICA8QXJyb3dMZWZ0IC8+XG4gICAgICA8c3BhbiBjbGFzc05hbWU9XCJzci1vbmx5XCI+UHJldmlvdXMgc2xpZGU8L3NwYW4+XG4gICAgPC9CdXR0b24+XG4gICk7XG59XG5cbmZ1bmN0aW9uIENhcm91c2VsTmV4dCh7XG4gIGNsYXNzTmFtZSxcbiAgdmFyaWFudCA9IFwib3V0bGluZVwiLFxuICBzaXplID0gXCJpY29uXCIsXG4gIC4uLnByb3BzXG59OiBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgQnV0dG9uPikge1xuICBjb25zdCB7IG9yaWVudGF0aW9uLCBzY3JvbGxOZXh0LCBjYW5TY3JvbGxOZXh0IH0gPSB1c2VDYXJvdXNlbCgpO1xuXG4gIHJldHVybiAoXG4gICAgPEJ1dHRvblxuICAgICAgZGF0YS1zbG90PVwiY2Fyb3VzZWwtbmV4dFwiXG4gICAgICB2YXJpYW50PXt2YXJpYW50fVxuICAgICAgc2l6ZT17c2l6ZX1cbiAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgIFwiYWJzb2x1dGUgc2l6ZS04IHJvdW5kZWQtZnVsbFwiLFxuICAgICAgICBvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCJcbiAgICAgICAgICA/IFwidG9wLTEvMiAtcmlnaHQtMTIgLXRyYW5zbGF0ZS15LTEvMlwiXG4gICAgICAgICAgOiBcIi1ib3R0b20tMTIgbGVmdC0xLzIgLXRyYW5zbGF0ZS14LTEvMiByb3RhdGUtOTBcIixcbiAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgKX1cbiAgICAgIGRpc2FibGVkPXshY2FuU2Nyb2xsTmV4dH1cbiAgICAgIG9uQ2xpY2s9e3Njcm9sbE5leHR9XG4gICAgICB7Li4ucHJvcHN9XG4gICAgPlxuICAgICAgPEFycm93UmlnaHQgLz5cbiAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInNyLW9ubHlcIj5OZXh0IHNsaWRlPC9zcGFuPlxuICAgIDwvQnV0dG9uPlxuICApO1xufVxuXG5leHBvcnQge1xuICB0eXBlIENhcm91c2VsQXBpLFxuICBDYXJvdXNlbCxcbiAgQ2Fyb3VzZWxDb250ZW50LFxuICBDYXJvdXNlbEl0ZW0sXG4gIENhcm91c2VsUHJldmlvdXMsXG4gIENhcm91c2VsTmV4dCxcbn07XG4iXX0=